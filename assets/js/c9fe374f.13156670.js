"use strict";(self.webpackChunktodo_doc=self.webpackChunktodo_doc||[]).push([[3836],{7152:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"level1/devops/deployment/auto-deployment","title":"**Automating Deployment with a Deploy Script**","description":"In this section, we\u2019ll explore the benefits of automating your deployment process using a deploy.sh script. By automating repetitive tasks, you can simplify and streamline your workflow, reduce errors, and ensure consistent deployments.","source":"@site/docs/level1/devops/deployment/auto-deployment.md","sourceDirName":"level1/devops/deployment","slug":"/level1/devops/deployment/auto-deployment","permalink":"/todo-doc/docs/level1/devops/deployment/auto-deployment","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":70,"frontMatter":{"sidebar_label":"Automated Deployment","sidebar_position":70},"sidebar":"tutorialSidebar","previous":{"title":"Process Manager","permalink":"/todo-doc/docs/level1/devops/deployment/process-mgr"},"next":{"title":"Web Server Setup","permalink":"/todo-doc/docs/category/web-server-setup"}}');var r=s(4848),i=s(8453);const o={sidebar_label:"Automated Deployment",sidebar_position:70},l="Automating Deployment with a Deploy Script",d={},c=[{value:"<strong>Why Automate Deployment?</strong>",id:"why-automate-deployment",level:2},{value:"<strong>Step-by-Step: Creating and Using a Deploy Script</strong>",id:"step-by-step-creating-and-using-a-deploy-script",level:2},{value:"<strong>Step 1: Create the <code>deploy.sh</code> Script</strong>",id:"step-1-create-the-deploysh-script",level:3},{value:"<strong>Step 2: Execute the Deployment Script</strong>",id:"step-2-execute-the-deployment-script",level:3},{value:"<strong>Step 3: Verify the Deployment</strong>",id:"step-3-verify-the-deployment",level:3},{value:"<strong>The Role of <code>npm install</code> in Your Deployment Script</strong>",id:"the-role-of-npm-install-in-your-deployment-script",level:2},{value:"<strong>Benefits of Using <code>deploy.sh</code></strong>",id:"benefits-of-using-deploysh",level:2}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"automating-deployment-with-a-deploy-script",children:(0,r.jsx)(n.strong,{children:"Automating Deployment with a Deploy Script"})})}),"\n",(0,r.jsxs)(n.p,{children:["In this section, we\u2019ll explore the benefits of automating your deployment process using a ",(0,r.jsx)(n.code,{children:"deploy.sh"})," script. By automating repetitive tasks, you can simplify and streamline your workflow, reduce errors, and ensure consistent deployments."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"why-automate-deployment",children:(0,r.jsx)(n.strong,{children:"Why Automate Deployment?"})}),"\n",(0,r.jsx)(n.p,{children:"Manually deploying your application can be time-consuming and error-prone. Here are the key benefits of using a deployment script:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Efficiency"}),": Automates repetitive tasks like syncing files, restarting services, and setting permissions."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consistency"}),": Ensures the same deployment steps are executed every time, reducing the likelihood of mistakes."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Simplicity"}),": Provides a single command to deploy your app, making the process faster and easier."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reproducibility"}),": Other team members or systems can use the same script to deploy the app reliably."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Improved Focus"}),": Lets you focus on developing features and debugging rather than managing deployment."]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"step-by-step-creating-and-using-a-deploy-script",children:(0,r.jsx)(n.strong,{children:"Step-by-Step: Creating and Using a Deploy Script"})}),"\n",(0,r.jsx)(n.h3,{id:"step-1-create-the-deploysh-script",children:(0,r.jsxs)(n.strong,{children:["Step 1: Create the ",(0,r.jsx)(n.code,{children:"deploy.sh"})," Script"]})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["In your project root directory, create a new directory named ",(0,r.jsx)(n.code,{children:"scripts"})]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["Inside the ",(0,r.jsx)(n.code,{children:"scripts/"})," directory, create a file named ",(0,r.jsx)(n.code,{children:"deploy.sh"})," and add the following content:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# Variables\nLIGHTSAIL_IP="your-lightsail-ip"      # Replace with your Lightsail instance IP\nSSH_USER="bitnami"                   # Replace with your instance username\nSSH_KEY="keys/lightsail-key.pem"     # Path to your SSH private key\nAPP_DIR="~/todo-app"                 # Remote app directory\nLOCAL_DIR="./"                       # Local app directory\n\n# Rsync files to the server\necho "Syncing files to the server..."\nrsync -avz --exclude-from=".rsyncignore" -e "ssh -i $SSH_KEY" "$LOCAL_DIR" "$SSH_USER@$LIGHTSAIL_IP:$APP_DIR"\n\n# SSH into the server to install dependencies and restart the app\necho "Connecting to the server to restart the app..."\nssh -i "$SSH_KEY" "$SSH_USER@$LIGHTSAIL_IP" <<EOF\ncd $APP_DIR\nnpm install\npm2 restart all || pm2 start server.js --name "todo-app"\nEOF\n\necho "Deployment complete!"\n'})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:["From a ",(0,r.jsx)(n.strong,{children:"local terminal"}),", make the script executable:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"chmod +x scripts/deploy.sh\n"})}),"\n",(0,r.jsx)(n.p,{children:"Note: The command chmod +x is used to make a file executable in Unix-based operating systems like Linux and macOS."}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"step-2-execute-the-deployment-script",children:(0,r.jsx)(n.strong,{children:"Step 2: Execute the Deployment Script"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["From your project root directory, run the script:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"./scripts/deploy.sh\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["The script will:","\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Sync your local files to the server using ",(0,r.jsx)(n.code,{children:"rsync"}),"."]}),"\n",(0,r.jsx)(n.li,{children:"SSH into the server to install dependencies and restart the app."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"step-3-verify-the-deployment",children:(0,r.jsx)(n.strong,{children:"Step 3: Verify the Deployment"})}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["After the script completes, visit your app in the browser using the Lightsail public IP (e.g., ",(0,r.jsx)(n.code,{children:"http://<your-lightsail-ip>"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:["From a ",(0,r.jsx)(n.strong,{children:"remote terminal"}),", check the PM2 process list on the server to ensure your app is running:","\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pm2 list\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"After you've verified the deployment script works as intended, be sure to commit it to git. It's as important to your project as your app's source code."}),"\n",(0,r.jsx)(n.li,{children:"Because the deployment script restarts the pm2 processes (which also restarts your Node.js app), any backend changes you made (like adding a new api route) will be incorporated."}),"\n",(0,r.jsxs)(n.li,{children:["You can now deploy changes from your ",(0,r.jsx)(n.strong,{children:"local terminal"}),", reducing the need to ssh into your remote server."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"the-role-of-npm-install-in-your-deployment-script",children:(0,r.jsxs)(n.strong,{children:["The Role of ",(0,r.jsx)(n.code,{children:"npm install"})," in Your Deployment Script"]})}),"\n",(0,r.jsxs)(n.p,{children:["When deploying your application, ensuring that the server has all the required dependencies is critical. Running ",(0,r.jsx)(n.code,{children:"npm install"})," as part of your deploy script helps keep the server environment in sync with the application's requirements."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Handles New Dependencies"}),":\nIf you've added new dependencies (or updated existing ones) in the ",(0,r.jsx)(n.code,{children:"dependencies"})," section of your ",(0,r.jsx)(n.code,{children:"package.json"})," since the last deployment, running ",(0,r.jsx)(n.code,{children:"npm install"})," will ensure they are installed on the server."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Keeps the Environment Consistent"}),":\nEnsures that all dependencies listed in your ",(0,r.jsx)(n.code,{children:"package.json"})," are present, preventing runtime errors due to missing modules."]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Automates Dependency Management"}),":\nIncluding ",(0,r.jsx)(n.code,{children:"npm install"})," in your deploy script eliminates the need to manually install dependencies on the server, simplifying the process and reducing errors."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"benefits-of-using-deploysh",children:(0,r.jsxs)(n.strong,{children:["Benefits of Using ",(0,r.jsx)(n.code,{children:"deploy.sh"})]})}),"\n",(0,r.jsxs)(n.p,{children:["By using a ",(0,r.jsx)(n.code,{children:"deploy.sh"})," script, you:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Eliminate repetitive tasks, saving time during deployment."}),"\n",(0,r.jsx)(n.li,{children:"Avoid forgetting critical steps, ensuring consistent results."}),"\n",(0,r.jsx)(n.li,{children:"Make deployments easy for other team members."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"This script serves as the foundation for more advanced deployment automation. As your project grows, you can expand it with features like environment-specific configurations or integration with CI/CD pipelines."})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>o,x:()=>l});var t=s(6540);const r={},i=t.createContext(r);function o(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);