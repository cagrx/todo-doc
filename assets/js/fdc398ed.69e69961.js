"use strict";(self.webpackChunktodo_doc=self.webpackChunktodo_doc||[]).push([[1255],{1107:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>r,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"level1/devops/web-setup/web-20","title":"Setting Up SSL Certificates and Redirecting HTTP to HTTPS for Your Node.js App on Lightsail","description":"This guide will walk you through the process of setting up SSL certificates using Certbot and configuring Nginx to redirect HTTP traffic to HTTPS for your Node.js application deployed on a Lightsail instance.","source":"@site/docs/level1/devops/web-setup/web-20.md","sourceDirName":"level1/devops/web-setup","slug":"/level1/devops/web-setup/web-20","permalink":"/todo-doc/docs/level1/devops/web-setup/web-20","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":500,"frontMatter":{"sidebar_label":"SSL Web Server Setup","sidebar_position":500},"sidebar":"tutorialSidebar","previous":{"title":"Create Domain Name","permalink":"/todo-doc/docs/level1/devops/web-setup/domain-name"},"next":{"title":"Final Housekeeping","permalink":"/todo-doc/docs/level1/devops/web-setup/final-housekeeping"}}');var o=i(4848),s=i(8453);const r={sidebar_label:"SSL Web Server Setup",sidebar_position:500},a="Setting Up SSL Certificates and Redirecting HTTP to HTTPS for Your Node.js App on Lightsail",l={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Steps",id:"steps",level:2},{value:"1. Add Domain Names to the Nginx Config File",id:"1-add-domain-names-to-the-nginx-config-file",level:3},{value:"1. Install Certbot and the Nginx Plugin",id:"1-install-certbot-and-the-nginx-plugin",level:3},{value:"2. Obtain an SSL Certificate",id:"2-obtain-an-ssl-certificate",level:3},{value:"3. Verify the Certificate",id:"3-verify-the-certificate",level:3},{value:"4. Inspect the Nginx configuration file",id:"4-inspect-the-nginx-configuration-file",level:3},{value:"5. Set Up Auto-Renewal",id:"5-set-up-auto-renewal",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2}];function c(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"setting-up-ssl-certificates-and-redirecting-http-to-https-for-your-nodejs-app-on-lightsail",children:"Setting Up SSL Certificates and Redirecting HTTP to HTTPS for Your Node.js App on Lightsail"})}),"\n",(0,o.jsx)(n.p,{children:"This guide will walk you through the process of setting up SSL certificates using Certbot and configuring Nginx to redirect HTTP traffic to HTTPS for your Node.js application deployed on a Lightsail instance."}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"A Node.js app listening on port 3004 and configured with Nginx on Lightsail."}),"\n",(0,o.jsx)(n.li,{children:"A domain name linked to your instance's static IP address."}),"\n",(0,o.jsx)(n.li,{children:"Nginx installed and running on your Lightsail instance."}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsxs)(n.blockquote,{children:["\n",(0,o.jsx)(n.p,{children:"Reminder: Since we're installing new software onto our server, it's a good idea to take a snapshot of it first."}),"\n"]}),"\n",(0,o.jsxs)(n.p,{children:["Perform the following steps from a ",(0,o.jsx)(n.strong,{children:"remote terminal"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,o.jsx)(n.h3,{id:"1-add-domain-names-to-the-nginx-config-file",children:"1. Add Domain Names to the Nginx Config File"}),"\n",(0,o.jsx)(n.p,{children:"Open the Nginx configuration file for your domain:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/nginx/sites-available/default\n"})}),"\n",(0,o.jsx)(n.p,{children:"The current version should look like this:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    server_name _; # Matches all requests, including those to the IP address\n\n    location / {\n        proxy_pass http://localhost:3004; # Forward requests to Node.js app\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n    }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["Instead of matching all requests, we want the ",(0,o.jsx)(n.code,{children:"server_name"})," to specify our domains, so modify the file to look like this (replacing yourdomain.com with your domain name):"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-nginx",children:"server {\n    listen 80;\n    server_name yourdomain.com www.yourdomain.com;\n\n    location / {\n        proxy_pass http://localhost:3004; # Forward requests to Node.js app\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n        proxy_set_header Host $host;\n        proxy_cache_bypass $http_upgrade;\n    }\n}\n"})}),"\n",(0,o.jsx)(n.h3,{id:"1-install-certbot-and-the-nginx-plugin",children:"1. Install Certbot and the Nginx Plugin"}),"\n",(0,o.jsx)(n.p,{children:"Run the following commands to install Certbot and the Nginx plugin:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo apt update\nsudo apt install certbot python3-certbot-nginx -y\n"})}),"\n",(0,o.jsx)(n.h3,{id:"2-obtain-an-ssl-certificate",children:"2. Obtain an SSL Certificate"}),"\n",(0,o.jsx)(n.p,{children:"Run Certbot to automatically configure SSL for your domain:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo certbot --nginx -d yourdomain.com -d www.yourdomain.com\n"})}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["Replace ",(0,o.jsx)(n.code,{children:"yourdomain.com"})," and ",(0,o.jsx)(n.code,{children:"www.yourdomain.com"})," with your actual domain names."]}),"\n",(0,o.jsxs)(n.li,{children:["Certbot will:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Verify your domain ownership."}),"\n",(0,o.jsx)(n.li,{children:"Automatically update your Nginx configuration to include SSL settings."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"When prompted, select the option to redirect HTTP traffic to HTTPS."}),"\n",(0,o.jsx)(n.h3,{id:"3-verify-the-certificate",children:"3. Verify the Certificate"}),"\n",(0,o.jsx)(n.p,{children:"After Certbot completes, test the certificate by visiting your site at:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["These should load with a secure HTTPS connection.","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"https://yourdomain.com"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"https://www.yourdomain.com"})}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(n.li,{children:["These should redirect to a secure HTTPS connection.","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"http://your domain.com"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"http://www.yourdomain.com"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"4-inspect-the-nginx-configuration-file",children:"4. Inspect the Nginx configuration file"}),"\n",(0,o.jsxs)(n.p,{children:["Open the Nginx configuration file for your domain and see the changes nginx made. ",(0,o.jsx)(n.strong,{children:"Do not change any values."})]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo nano /etc/nginx/sites-available/default\n"})}),"\n",(0,o.jsx)(n.h3,{id:"5-set-up-auto-renewal",children:"5. Set Up Auto-Renewal"}),"\n",(0,o.jsx)(n.p,{children:"Certbot automatically renews certificates, but you should verify the renewal process:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"sudo certbot renew --dry-run\n"})}),"\n",(0,o.jsx)(n.p,{children:"If no errors occur, your SSL certificates will renew automatically."}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Domain Verification Issues"}),": Ensure your domain\u2019s DNS records are correctly pointing to your Lightsail instance\u2019s static IP."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Firewall Issues"}),": Open ports 80 and 443 on your Lightsail instance. Use the Lightsail console to manage instance firewall settings."]}),"\n"]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.p,{children:"Congratulations! Your Node.js app is now accessible over HTTPS, and all HTTP traffic is redirected to HTTPS."})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>a});var t=i(6540);const o={},s=t.createContext(o);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);